<!DOCTYPE html>
<html>
<head>
    <title>The second part</title>
    <meta charset="utf-8"/>
    <link rel="stylesheet" href="assets/normalize-css/normalize.css"/>
    <link rel="stylesheet" href="assets/font-awesome/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="assets/highlightjs/styles/tomorrow.css"/>
    <link rel="stylesheet" href="assets/ruban/css/ruban.min.css"/>
    <link rel="stylesheet" href="assets/ruban/css/ruban-print.min.css" media="print"/>
    <link rel="stylesheet" href="style.css"/>
</head>

<body>
<script charset="utf-8">
    var demo = { };
</script>

<section>
    <h1>Javascript - The Strike Back</h1>
</section>

<section>
    <h1>Functions</h1>
    <ul>
        <li>Declaration : <pre><code class='javascript'>function name (parameters){/*function content*/}</code></pre></li>
        <li>Expression : <pre><code class='javascript'>var name = function optionalName (parameters){/*function content*/}</code></pre></li>
        <li>return is optional but always exists ! - defaults to undefined</li>
        <li>Every function is actually a Function object</li>
    </ul>
</section>
<section>
    <h1>Function Hoisting</h1>
    <pre><code class='javascript'>
function car() {
    pouet(); 
    function pouet(){console.log('poueeet');}
}
function car() {
    pouet(); //ERROR !!
    var klaxon = 
        function pouet(){console.log('poueeet');}
}
    </code></pre>
</section>
<section>
        <h1  style="margin-bottom: -10px;">Functions - self executing</h1>
        <p>content inside () is evaluated as an expression</p>
<pre style="margin-top: -20px;"><code class='javascript' style='font-size: 50%;'>
function test(){return 'Bonita!';}; 
    //function definition, returns undefined
(2 + 2) // returns 4
(function test(){return 'Bonita!';}); 
                // returns [object Function]
(function test(){return 'Bonita!';})(); 
                // returns 'Bonita !'
</code></pre>
</section>
<section>
        <h1 style="
    margin-bottom: -10px;
">Functions - Arguments</h1>
        <b>optionals...</b>
<pre style="
    margin-top: -20px;
"><code class='javascript'>
function pouet(){
    console.log('pouet!');
}
pouet();
pouet('beeeeeeeeeeeep!');
 // /!\ pitfall !!
['10', '10', '10', '10', '10'].map(parseInt);
</code></pre>
</section>
<section>
      <h1 style="
    margin-bottom: -10px;
">Functions - Arguments</h1> 
<b>Functions are defined only by their name => Override</b>
<pre style="
    margin-top: -20px;
"><code class='javascript'>
(function example(){
    function klaxon(){
        console.log('beeeeeeeeeeeeeeep');
    }
    function klaxon(sound){
        console.log(sound);
    }
    klaxon('poueeeeeeeeeeeeet');
    klaxon();
})();
</code></pre>
</section>
<section>
        <h1>Functions - Attribute</h1> 
        <ul>
            <li>length</li>
            <li>caller</li>
            <li>arguments{ callee (/!\ strict mode ES5, length}</li> 
            <li>name (ES6) &amp; displayName</li>
            <li><a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments/callee'>https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments/callee</a></li>
        </ul>

</section>
<section>
      <h1 style="
    margin-bottom: -10px;
">Functions - Attribute</h1> 
<pre style="
    margin-top: -20px;
"><code class='javascript'>
function jukebox(){
    var feature = function play(sound){
        console.log(play.length);
        console.log(play.caller);
        console.log(play.arguments);
        console.log(play.arguments.callee);
        console.log(play.arguments.length);
        console.log(play.name);
        console.log(feature.name);
    }
    feature('test');
}
jukebox();
</code></pre>
</section>
<section>
      <h1 style="margin-bottom: -10px;">Functions - Attribute</h1> 
<pre style="margin-top: -20px;"><code class='javascript'>
function jukebox(){
    var play = function (sound){
        console.log(play.length);
        console.log(play.caller);
        console.log(play.arguments);
        console.log(play.arguments.callee);
        console.log(play.arguments.length);
        console.log(play.name);
    }
    play('test');
}
jukebox();
</code></pre>
</section>
<section>
        <h1  style="margin-bottom: -10px;">Functions - <i>this</i></h1>
        <ul> 
        <li>represents the context object associated to the function</li>
        <li> /!\ different from Function.caller</li>
        <li>similar to <i>this</i> in Java but be careful...</li>
        </ul>
<pre style="margin-top: -20px;"><code class='javascript' style='font-size: 40%;'>
function Car(name){
    this.name = name;
    this.showYourself = function showYourself(){
        console.log(this);
        console.log(showYourself.caller);
    };
    this.showYourself()
};
(function policeCheckPoint(){console.log(this);new Car('toyota').showYourself()})();
</code></pre>
        
</section>
<section>
        <h1  style="margin-bottom: -10px;">Functions - <i>this</i></h1>
<pre style="margin-top: -20px;"><code class='javascript'>
this.x = 9; 
var module = {
  x: 81,
  getX: function() { return this.x; }
}; // same as new Object()

module.getX(); // 81

var getX = module.getX;
getX(); // 9, because in this case, "this" refers to the global object

</code></pre>
        
</section>
<section>
        <h2>Functions - <i>this</i> - change it !</h2> 
        <ul>
        <li>call()</li><li>apply()</li><li> bind()</li><li> new</li>
        </ul>
</section>

<section>
        <h2>Functions - <i>this</i> - apply &amp; call</h2> 
        <ul>
        <li>fun.call(thisArg[, arg1[, arg2[, ...]]])</li>
        <li>fun.apply(thisArg, [argsArray])</li>
        </ul>
</section>
<section>
        <h1 style="margin-bottom: -10px;">Functions - Attribute</h1>
        <b>optional parameters : optional callback pattern</b>
<pre style="margin-top: -20px;"><code class='javascript' style='font-size: 40%;'>
function getData (id/*, parameters, callback*/) {
  var id = arguments[0], parameters, callback;

  if (arguments.length === 2) { // only two arguments supplied
    if (Object.prototype.toString.call(arguments[1]) === "[object Function]") {
      callback = arguments[1]; // if is a function, set as 'callback'
    } else {
      parameters = arguments[1]; // if not a function, set as 'parameters'
    }
  } else if (arguments.length >= 3) { // three arguments supplied
      parameters = arguments[1];
      if(typeof arguments[arguments.length-1] === 'function'){
        callback = arguments[arguments.length-1];
      } else {
        var parameters = Array.prototype.slice.call(arguments,1,arguments.length-1);
        //var parameters = Array.prototype.slice.apply(arguments,[1,arguments.length-1]);
      }
  }
}         
</code></pre>
</section>
<section>
        <h1  style="margin-bottom: -10px;">Functions - <i>this</i> - bind</h1>
<p>creates new function on the specified object<br/>
<pre style="margin-top: -20px;"><code class='javascript' style='font-size: 40%;'>
this.x = 9; 
var module = {
  x: 81,
  getX: function() { return this.x; }
};

module.getX(); // 81

var getX = module.getX;
getX(); // 9, because in this case, "this" refers to the global object

// create a new function with 'this' bound to module
var boundGetX = getX.bind(module);
boundGetX(); // 81
</code></pre>
        
</section>

<section>
        <h1  style="margin-bottom: -10px;">Functions - <i>this</i> - bind</h1>
        <b>Partial function</b>

<pre style="margin-top: -20px;"><code class='javascript' style='font-size: 40%;'>
function list() {
  return Array.prototype.slice.call(arguments);
}

var list1 = list(1, 2, 3); // [1, 2, 3]

//  Create a function with a preset leading argument
var leadingBonitaList = list.bind(undefined, 'Bonita!');

var list2 = leadingBonitaList(); // ['Bonita!']
var list3 = leadingBonitaList(1, 2, 3); // ['Bonita!', 1, 2, 3]
        
</section>

<section>
        <h1  style="margin-bottom: -10px;">Functions - <i>this</i> - pitfall</h1>
<pre style="margin-top: -20px;"><code class='javascript' style='font-size: 40%;'>
function Car(color){
    this.partsToColor = 
            [{name : 'seats', color : color},
             {name : 'stirringWheel', color : color}, 
             {name : 'outside', color : color}]
    this.mainColor = color;
    this.changeMainColor = function(color){ this.mainColor = color;}
    this.applyColorChange = function(){
        this.partsToColor = this.partsToColor.map(function(partToColor){ partToColor.color = this.mainColor; return partToColor;});
    };
    this.showDaCar = function(){
        console.log(this.partsToColor);
    }
}
var myCar = new Car('blue');
myCar.showDaCar();
myCar.changeMainColor('black');
myCar.applyColorChange();
myCar.showDaCar();
</code></pre>
        
</section>
<section>
        <h1  style="margin-bottom: -10px;">Functions - <i>this</i> - pitfall</h1>
<pre style="margin-top: -20px;"><code class='javascript' style='font-size: 40%;'>
function Car(color){
    this.partsToColor = 
            [{name : 'seats', color : color}, 
             {name : 'stirringWheel', color : color}, 
             {name : 'outside', color : color}]
    this.mainColor = color;
    this.changeMainColor = function(color){ this.mainColor = color;}
    this.applyColorChange = function(){
        var self = this;
        this.partsToColor = this.partsToColor.map(function(partToColor){ partToColor.color = self.mainColor; return partToColor;});
    };
    this.showDaCar = function(){
        console.log(this.partsToColor);
    }
}
var myCar = new Car('blue');
myCar.showDaCar();
myCar.changeMainColor('black');
myCar.applyColorChange();
myCar.showDaCar();
</code></pre>
        
</section>
<section>
        <h1>Functions - Closure</h1> 
        <li>Closure (lambda)</li>
        <li>variables scope</li>
        <li>anonymous function</li>
        always put a name to your function (debugging purpose)...
        <li>strict overriding</li>
<pre style="margin-top: -20px;"><code class='javascript'>
function addMethod(object, name, fn){
    var old = object[ name ];
    if ( old )
        object[ name ] = function(){
            if ( fn.length == arguments.length )
                return fn.apply( this, arguments );
            else if ( typeof old == 'function' )
                return old.apply( this, arguments );
        };
    else
        object[ name ] = fn;
}
</code></pre>
    </ul>
</section>
<section>
        <h1>Functions - self execution</h1> 
        <li>private data</li>
        <li>module pattern</li>
        <li>revealing module pattern</li>
    </ul>
</section>

<section>
    <h1>Object</h1>
    <ul>
        <li>Prototype</li>
        <li>Read &amp; write - walk though prototype chain specificity</li>
        <li>Inheritance
            http://krasimirtsonev.com/blog/article/object-oriented-programming-oop-in-javascript-extending-Inheritance-classes
            https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Inheritance_and_the_prototype_chain</li>
        <li>Expand prototype</li>
        <pre><code class="javascript">
var Car = function() {
    // constructor
}
Car.prototype.stuff = '';
        </code></pre>
    </ul>
</section>

<script src="assets/jquery/jquery.min.js"></script>
<script src="assets/keymaster/keymaster.js"></script>
<script src="assets/hammerjs/hammer.min.js"></script>
<script src="assets/highlightjs/highlight.pack.js"></script>
<script src="assets/ruban/js/ruban.min.js"></script>
<script>
    new Ruban();
    hljs.initHighlightingOnLoad();
</script>
</body>
</html>

